obsSIG=readOGR(dsn=path,layer=layerdata)
landSIG=readOGR(dsn=path,layer=layerland)
mx=847587.4
my=6297998
#Creation var explicative paysage
#Conventionnel 1
# Bio 0
vecBio=c()
vecBio[landSIG$Protection==2 | landSIG$Protection==3 | landSIG$Protection==15]="conv"
vecBio[landSIG$Protection==0 & (landSIG$Occupation==3 | landSIG$Occupation==4 |landSIG$Occupation==11 )]="Conv"
vecBio[landSIG$Protection==5 | landSIG$Protection==6 | landSIG$Protection==16]="org"
vec12=1*(landSIG$Occupation==12) #vigne
vec12[vec12==1]="vine"
landSIG@data=cbind(landSIG@data,BioConv=vecBio,vigne=as.vector(vec12))
landSIG2=landSIG
landSIG2@data<-landSIG@data[,-c(1:15)]
names(landSIG2)<-c("OrgConv","Vine")
## changement des coordiantes
land<-st_as_sf(landSIG2)
geoland = st_geometry(land)
ncg2 = (geoland - c(mx,my))
d1<-as(ncg2, "Spatial")
uu=SpatialPolygonsDataFrame(d1, data=landSIG2@data,match.ID=F)
landSIG2=uu
###########################################################################################
# donnees observees
#jeux de donn?es brut
#verger abandonn?
#NumVerger 115
obsSIG=obsSIG[-(258:287),]
yname="carp"
#Creation colonne var ? expliquer
#Somme de tous les carpo observ?s male et femelles
obsSIG@data=cbind(obsSIG@data,carp=obsSIG@data[,"CarpoVivan"]+obsSIG@data[,"CarpoViv_1"])
dobs=as.data.frame(cbind(coordinates(obsSIG),obsSIG@data[,yname]))
dobs[,"orchard"]=factor(obsSIG@data[,"NumVergerC"])
colnames(dobs)=c("X","Y","Cmoth","orchard")
dobs[,"trait"]=0
trait=read.table("Carpo0607Riccietal09.csv",header=T)
oo=as.numeric(unique(as.vector(dobs[,"orchard"])))
for (i in oo)
{
print(i)
s=trait[,1]==i
if(sum(s)>0)
{
v=trait[s,"IFT_carpo_06"]
s=dobs[,"orchard"]==i
dobs[s,"trait"]=v
}
}
dataC=dobs
numorch=dobs[,"orchard"]
dataCmothM=cbind(tapply(dataC[,1],numorch,mean) ,  tapply(dataC[,2],numorch,mean) , tapply(dataC[,3],numorch,mean) , tapply(dataC[,5],numorch,mean)  )
dataCmothM=as.data.frame(dataCmothM)
colnames(dataCmothM)=c("X","Y","Cmoth","trait")
dataCmothM[,"X"]=dataCmothM[,"X"]-mx
dataCmothM[,"Y"]=dataCmothM[,"Y"]-my
obsSIG2=SpatialPointsDataFrame(coords=dataCmothM[,c("X","Y")],data=dataCmothM)
writeOGR(landSIG2,dsn="Carpo/SIGpackage/",layer="landCarpo",driver="ESRI Shapefile",overwrite_layer = T, layer_options = "ENCODING=UTF-8")
writeOGR(obsSIG2,dsn="Carpo/SIGpackage/",layer="dataCarpo",driver="ESRI Shapefile",overwrite_layer = T, layer_options = "ENCODING=UTF-8")
tt=readOGR(dsn = "Carpo/SIGpackage/",layer="dataCarpo")
tt@data
plot(tt)
axis(1)
axis(2)
tt=readOGR(dsn = "Carpo/SIGpackage/",layer="landCarpo")
tt@data
plot(tt)
axis(1)
axis(2)
ind1=tt@data[,"Vine"]=="vine"
plot(tt[ind1,],col=2,add=T)
ind2=tt@data[,"OrgConv"]=="Org"
ind2[is.na(ind2)]<-F
plot(tt[ind2,],col=3,add=T)
ind3=tt@data[,"OrgConv"]=="Conv"
ind1=tt@data[,"Vine"]=="vine"
plot(tt[ind1,],col=2,add=T)
ind2=tt@data[,"OrgConv"]=="org"
ind2[is.na(ind2)]<-F
plot(tt[ind2,],col=3,add=T)
ind3=tt@data[,"OrgConv"]=="conv"
ind3[is.na(ind3)]<-F
plot(tt[ind3,],col=4,add=T)
library(siland)
dataCmoth=data.gis(dsn = "Carpo/SIGpackage/",layer="dataCarpo",varname=c("Cmoth","trait"))
landCmoth=land.gis(dsn = "Carpo/SIGpackage/",layer="landCarpo",varname=c("OrgConv"),landname = c("Conv","Org"),wd=40)
dataCmoth=data.gis(dsn = "Carpo/SIGpackage/",layer="dataCarpo",varname=c("Cmoth","trait"))
landCmoth=land.gis(dsn = "Carpo/SIGpackage/",layer="landCarpo",varname=c("OrgConv"),landname = c("conv","org"),wd=40)
landCmoth[3]=land.gis(dsn = "Carpo/SIGpackage/",layer="landCarpo",varname=c("Vine"),landname = c("vine"),wd=40)
names(landCmoth)=c("Conv","Org","vine")
res3G=siland(loc.model= Cmoth~trait, land=landCmoth, data=dataCmoth, sif="gaussian", test=T, family="gaussian")
res3G
dataCmoth=data.gis(dsn = "Carpo/SIGpackage/",layer="dataCarpo",varname=c("Cmoth","trait"))
landCmoth=land.gis(dsn = "Carpo/SIGpackage/",layer="landCarpo",varname=c("OrgConv"),landname = c("conv","org"),wd=40)
landCmoth[3]=land.gis(dsn = "Carpo/SIGpackage/",layer="landCarpo",varname=c("Vine"),landname = c("vine"),wd=40)
names(landCmoth)=c("Conv","Org","Vine")
## changement des coordiantes
land<-st_as_sf(landSIG2)
plot(land)
dataCmoth=data.gis(dsn = "Carpo/SIGpackage/",layer="dataCarpo",varname=c("Cmoth","trait"))
landCmoth=land.gis(dsn = "Carpo/SIGpackage/",layer="landCarpo",varname=c("OrgConv"),landname = c("conv","org"),wd=40)
landCmoth[3]=land.gis(dsn = "Carpo/SIGpackage/",layer="landCarpo",varname=c("Vine"),landname = c("vine"),wd=40)
names(landCmoth)=c("Conv","Org","Vine")
res3G=siland(loc.model= Cmoth~trait, land=landCmoth, data=dataCmoth, sif="gaussian", test=T, family="gaussian")
landCmoth[[1]][1:10,]
landCmoth[[2]][1:10,]
landCmoth[[2]][,3]
source("../siland/R/land.gis.R")
landCmoth=land.gis(dsn = "Carpo/SIGpackage/",layer="landCarpo",varname=c("OrgConv"),landname = c("conv","org"),wd=40)
landCmoth[[1]][1:10,]
dsn = "Carpo/SIGpackage/"
layer="landCarpo"
landGIS=readOGR(dsn=dsn,layer=layer)
landname = c("conv","org")
varname=c("OrgConv")
j=1
m=c()
tmp=landGIS@data[,varname]
tmp
rm(list=ls())
##########################################################################################
#  Lecture des donn?es
##########################################################################################
path="./Carpo"
#Nom du fichier des donn?es
layerdata="copacabana_PSH_BP06"
#Nom du fichier de la var paysag?re
layerland="copacabanapommiers"
obsSIG=readOGR(dsn=path,layer=layerdata)
landSIG=readOGR(dsn=path,layer=layerland)
mx=847587.4
my=6297998
#Creation var explicative paysage
#Conventionnel 1
# Bio 0
vecBio=c()
vecBio[landSIG$Protection==2 | landSIG$Protection==3 | landSIG$Protection==15]="conv"
vecBio[landSIG$Protection==0 & (landSIG$Occupation==3 | landSIG$Occupation==4 |landSIG$Occupation==11 )]="Conv"
vecBio[landSIG$Protection==0 & (landSIG$Occupation==3 | landSIG$Occupation==4 |landSIG$Occupation==11 )]="conv"
vecBio[landSIG$Protection==5 | landSIG$Protection==6 | landSIG$Protection==16]="org"
vec12=1*(landSIG$Occupation==12) #vigne
vec12[vec12==1]="vine"
landSIG@data=cbind(landSIG@data,BioConv=vecBio,vigne=as.vector(vec12))
landSIG2=landSIG
landSIG2@data<-landSIG@data[,-c(1:15)]
names(landSIG2)<-c("OrgConv","Vine")
## changement des coordiantes
land<-st_as_sf(landSIG2)
geoland = st_geometry(land)
ncg2 = (geoland - c(mx,my))
d1<-as(ncg2, "Spatial")
uu=SpatialPolygonsDataFrame(d1, data=landSIG2@data,match.ID=F)
landSIG2=uu
###########################################################################################
# donnees observees
#jeux de donn?es brut
#verger abandonn?
#NumVerger 115
obsSIG=obsSIG[-(258:287),]
yname="carp"
#Creation colonne var ? expliquer
#Somme de tous les carpo observ?s male et femelles
obsSIG@data=cbind(obsSIG@data,carp=obsSIG@data[,"CarpoVivan"]+obsSIG@data[,"CarpoViv_1"])
dobs=as.data.frame(cbind(coordinates(obsSIG),obsSIG@data[,yname]))
dobs[,"orchard"]=factor(obsSIG@data[,"NumVergerC"])
colnames(dobs)=c("X","Y","Cmoth","orchard")
dobs[,"trait"]=0
trait=read.table("Carpo0607Riccietal09.csv",header=T)
oo=as.numeric(unique(as.vector(dobs[,"orchard"])))
for (i in oo)
{
print(i)
s=trait[,1]==i
if(sum(s)>0)
{
v=trait[s,"IFT_carpo_06"]
s=dobs[,"orchard"]==i
dobs[s,"trait"]=v
}
}
dataC=dobs
numorch=dobs[,"orchard"]
dataCmothM=cbind(tapply(dataC[,1],numorch,mean) ,  tapply(dataC[,2],numorch,mean) , tapply(dataC[,3],numorch,mean) , tapply(dataC[,5],numorch,mean)  )
dataCmothM=as.data.frame(dataCmothM)
colnames(dataCmothM)=c("X","Y","Cmoth","trait")
dataCmothM[,"X"]=dataCmothM[,"X"]-mx
dataCmothM[,"Y"]=dataCmothM[,"Y"]-my
obsSIG2=SpatialPointsDataFrame(coords=dataCmothM[,c("X","Y")],data=dataCmothM)
writeOGR(landSIG2,dsn="Carpo/SIGpackage/",layer="landCarpo",driver="ESRI Shapefile",overwrite_layer = T, layer_options = "ENCODING=UTF-8")
writeOGR(obsSIG2,dsn="Carpo/SIGpackage/",layer="dataCarpo",driver="ESRI Shapefile",overwrite_layer = T, layer_options = "ENCODING=UTF-8")
tt=readOGR(dsn = "Carpo/SIGpackage/",layer="dataCarpo")
tt@data
plot(tt)
axis(1)
axis(2)
tt=readOGR(dsn = "Carpo/SIGpackage/",layer="landCarpo")
tt@data
plot(tt)
axis(1)
axis(2)
ind1=tt@data[,"Vine"]=="vine"
plot(tt[ind1,],col=2,add=T)
ind2=tt@data[,"OrgConv"]=="org"
ind2[is.na(ind2)]<-F
plot(tt[ind2,],col=3,add=T)
ind3=tt@data[,"OrgConv"]=="conv"
ind3[is.na(ind3)]<-F
plot(tt[ind3,],col=4,add=T)
dsn = "Carpo/SIGpackage/"
layer="landCarpo"
varname=c("OrgConv")
landname = c("conv","org")
wd=40
landGIS=readOGR(dsn=dsn,layer=layer)
m=c()
j=1
tmp=landGIS@data[,varname]
#tmp[is.na(tmp)]=0
vec=ifelse(tmp==landname[j],1,0)
m=cbind(m,vec)
m
tmp=landGIS@data[,varname]
tmp[is.na(tmp)]=0
tmp=as.vector(landGIS@data[,varname])
tmp[is.na(tmp)]=0
vec=ifelse(tmp==landname[j],1,0)
m=c()
m=cbind(m,vec)
m
j=2
tmp=as.vector(landGIS@data[,varname])
tmp[is.na(tmp)]=0
vec=ifelse(tmp==landname[j],1,0)
m=cbind(m,vec)
m
#discretisation of landscape variable
#creation of a list of matrix with discretized landscape variables
lobs=list(NULL)
landGIS@data=as.data.frame(m)
colnames(landGIS@data)=landname
#discretisation of landscape variable
#creation of a list of matrix with discretized landscape variables
lobs=list(NULL)
for (i in 1:length(landname))
{
if(is.null(extentLand))
extentLand=extent(landGIS)
r=raster(ncol=round(extentLand@ymax-extentLand@ymin)/wd, nrow=round(extentLand@xmax-extentLand@xmin)/wd)
extent(r)=extentLand
rland=rasterize(landGIS,r,landname[i],fun='max')
rlandpos=as.data.frame(rasterToPoints(rland))
colnames(rlandpos)=c("X","Y",landname[i])
lobs[[i]]=rlandpos
}
extentLand=NULL
extentLand=extent(landGIS)
#discretisation of landscape variable
#creation of a list of matrix with discretized landscape variables
lobs=list(NULL)
for (i in 1:length(landname))
{
if(is.null(extentLand))
extentLand=extent(landGIS)
r=raster(ncol=round(extentLand@ymax-extentLand@ymin)/wd, nrow=round(extentLand@xmax-extentLand@xmin)/wd)
extent(r)=extentLand
rland=rasterize(landGIS,r,landname[i],fun='max')
rlandpos=as.data.frame(rasterToPoints(rland))
colnames(rlandpos)=c("X","Y",landname[i])
lobs[[i]]=rlandpos
}
names(lobs)=landname
lob[[1]]
lobs[[1]]
m=c()
for(j in 1:length(landname))
{
#vec=c( )
tmp=as.vector(landGIS@data[,varname])
tmp[is.na(tmp)]=0
vec=ifelse(tmp==landname[j],1,NA)
if (sum(vec,na.rm=T)==0){print(paste("No category",landname[j],"in the",varname,"variable."))}
m=cbind(m,vec)
}
landGIS@data=as.data.frame(m)
landname
m=c()
for(j in 1:length(landname))
{
#vec=c( )
tmp=as.vector(landGIS@data[,varname])
tmp[is.na(tmp)]=0
vec=ifelse(tmp==landname[j],1,NA)
if (sum(vec,na.rm=T)==0){print(paste("No category",landname[j],"in the",varname,"variable."))}
m=cbind(m,vec)
}
landGIS=readOGR(dsn=dsn,layer=layer)
m=c()
for(j in 1:length(landname))
{
#vec=c( )
tmp=as.vector(landGIS@data[,varname])
tmp[is.na(tmp)]=0
vec=ifelse(tmp==landname[j],1,NA)
if (sum(vec,na.rm=T)==0){print(paste("No category",landname[j],"in the",varname,"variable."))}
m=cbind(m,vec)
}
landGIS@data=as.data.frame(m)
colnames(landGIS@data)=landname
#discretisation of landscape variable
#creation of a list of matrix with discretized landscape variables
lobs=list(NULL)
for (i in 1:length(landname))
{
if(is.null(extentLand))
extentLand=extent(landGIS)
r=raster(ncol=round(extentLand@ymax-extentLand@ymin)/wd, nrow=round(extentLand@xmax-extentLand@xmin)/wd)
extent(r)=extentLand
rland=rasterize(landGIS,r,landname[i],fun='max')
rlandpos=as.data.frame(rasterToPoints(rland))
colnames(rlandpos)=c("X","Y",landname[i])
lobs[[i]]=rlandpos
}
names(lobs)=landname
lobs[[1]]
source("../siland/R/land.gis.R")
landCmoth=land.gis(dsn = "Carpo/SIGpackage/",layer="landCarpo",varname=c("OrgConv"),landname = c("conv","org"),wd=40)
landCmoth[3]=land.gis(dsn = "Carpo/SIGpackage/",layer="landCarpo",varname=c("Vine"),landname = c("vine"),wd=40)
dataCmoth=data.gis(dsn = "Carpo/SIGpackage/",layer="dataCarpo",varname=c("Cmoth","trait"))
landCmoth=land.gis(dsn = "Carpo/SIGpackage/",layer="landCarpo",varname=c("OrgConv"),landname = c("conv","org"),wd=40)
landCmoth[3]=land.gis(dsn = "Carpo/SIGpackage/",layer="landCarpo",varname=c("Vine"),landname = c("vine"),wd=40)
names(landCmoth)=c("Conv","Org","Vine")
res3G=siland(loc.model= Cmoth~trait, land=landCmoth, data=dataCmoth, sif="gaussian", test=T, family="gaussian")
summary(res3G)
res2G=siland(loc.model= Cmoth~trait, land=landCmoth[c(1,2)], data=dataCmoth, sif="gaussian", test=T, family="gaussian")
summary(res2G)
#Data loading with data.gis() and land.gis() functions
dataCmoth=data.gis(dsn="./GIS",layer="dataCarpo",varname=c("Cmoth","trait"))
setwd("/media/biometrie/omartin/Work/silandPackageGit/Materials_MEE")
#Data loading with data.gis() and land.gis() functions
dataCmoth=data.gis(dsn="./GIS",layer="dataCarpo",varname=c("Cmoth","trait"))
landCmoth1=land.gis(dsn="./GIS",layer="landCarpo",varname="OrgConv",landname = c("org","conv"),wd=40)
landCmoth2=land.gis(dsn="./GIS",layer="landCarpo",varname="Vine",landname = "vine",wd=40)
landCmoth=c(landCmoth1,landCmoth2)
names(landCmoth)
plot(landCmoth[[2]][,1:2])
#Estimation with a gaussian SIF
res3G=siland(loc.model=Cmoth~trait,land=landCmoth,data=dataCmoth,sif="gaussian",test=T,family=gaussian)
res3G
summary(res3G)
res2G=siland(loc.model=Cmoth~trait,land=landCmoth[c(1,2)],data=dataCmoth,sif="gaussian",test=T,family=gaussian)
res2G
#Data loading with data.gis() and land.gis() functions
dataCmoth=data.gis(dsn="./GIS",layer="dataCarpo",varname=c("Cmoth","trait"))
landCmoth1=land.gis(dsn="./GIS",layer="landCarpo",varname="OrgConv",landname = c("conv","org"),wd=40)
landCmoth2=land.gis(dsn="./GIS",layer="landCarpo",varname="Vine",landname = "vine",wd=40)
landCmoth=c(landCmoth1,landCmoth2)
names(landCmoth)
#Estimation with a gaussian SIF
res3G=siland(loc.model=Cmoth~trait,land=landCmoth,data=dataCmoth,sif="gaussian",test=T,family=gaussian)
summary(res3G)
res2G=siland(loc.model=Cmoth~trait,land=landCmoth[c(1,2)],data=dataCmoth,sif="gaussian",test=T,family=gaussian)
summary(res2G)
plotsiland.land(res2G,land=landCmoth[c(1,2)],data=dataCmoth,var=1)
plotsiland.land(res2G,land=landCmoth[c(1,2)],data=dataCmoth,var=2)
plotsiland.land(res2G,land=landCmoth[c(1,2)],data=dataCmoth,var=0)
plotsiland.land(res2G,land=landCmoth[c(1,2)],data=dataCmoth,var=1)
setwd("/media/biometrie/omartin/Work/silandPackageGit/Materials_MEE")
rm(list=ls())
#Data loading with data.gis() and land.gis() functions
dataCmoth=data.gis(dsn="./GIS",layer="dataCarpo",varname=c("Cmoth","trait"))
rm(list=sl())
rm(list=ls())
remove.packages("siland")
q()
ls()
install.packages("~/Work/silandPackageGit/Downloads/PackageSource/siland_1.2.tar.gz", repos = NULL, type = "source")
library(siland)
#Data loading with data() function
data(dataCmoth)
data(landCmoth)
#Data loading with data.gis() and land.gis() functions
dataCmoth=data.gis(dsn="./GIS",layer="dataCarpo",varname=c("Cmoth","trait"))
landCmoth1=land.gis(dsn="./GIS",layer="landCarpo",varname="OrgConv",landname = c("conv","org"),wd=40)
landCmoth2=land.gis(dsn="./GIS",layer="landCarpo",varname="Vine",landname = "vine",wd=40)
landCmoth=c(landCmoth1,landCmoth2)
names(landCmoth)
#Estimation with a gaussian SIF
res3G=siland(loc.model=Cmoth~trait,land=landCmoth,data=dataCmoth,sif="gaussian",test=T,family=gaussian)
summary(res3G)
res2G=siland(loc.model=Cmoth~trait,land=landCmoth[c(1,2)],data=dataCmoth,sif="gaussian",test=T,family=gaussian)
summary(res2G)
#Estimation on a simulated example
?landSiland
?dataSiland
data("dataSiland")
data("landSiland")
siland(loc.model= y~varloc+(1|Id), land=landSiland, data=dataSiland, sif="exponential", test=T, family="poisson")
siland(loc.model= y~locvar+(1|Id), land=landSiland, data=dataSiland, sif="exponential", test=T, family="poisson")
res2G=siland(loc.model= Cmoth~trait, land=landCmoth[c(1,2)],data=dataCmoth, sif="exponential", test=T,family=gaussian)
summary(res2G)
siland.quantile(res2G,c(0.5,0.95))
res2G=siland(loc.model=Cmoth~trait,land=landCmoth[c(1,2)],data=dataCmoth,sif="gaussian",test=T,family=gaussian)
siland.quantile(res2G,c(0.5,0.95))
plotsiland.land(res2G,land=landCmoth[c(1,2)],data=dataCmoth,var=1)
plotsiland.land(res2G,land=landCmoth[c(1,2)],data=dataCmoth,var=2)
save(dataCmoth,file="dataCmoth.RData")
save(landCmoth,file="landCmoth.RData")
q()
install.packages("~/Work/silandPackageGit/Downloads/PackageSource/siland_1.2.tar.gz", repos = NULL, type = "source")
library(siland)
#Data loading with data() function
data(dataCmoth)
data(landCmoth)
#Estimation with a gaussian SIF
res3G=siland(loc.model=Cmoth~trait,land=landCmoth,data=dataCmoth,sif="gaussian",test=T,family=gaussian)
res2G=siland(loc.model=Cmoth~trait,land=landCmoth[c(1,2)],data=dataCmoth,sif="gaussian",test=T,family=gaussian)
res2G
plotsiland.land(res2G,land=landCmoth[c(1,2)],data=dataCmoth,var=1)
plotsiland(res2G,landCmoth[c(1,2)],dataCmoth)
remove.packages("siland")
q()
install.packages("~/Work/silandPackageGit/Downloads/PackageSource/siland_1.2.tar.gz", repos = NULL, type = "source")
library(siland)
#Data loading with data() function
data(dataCmoth)
data(landCmoth)
res2G=siland(loc.model=Cmoth~trait,land=landCmoth[c(1,2)],data=dataCmoth,sif="gaussian",test=T,family=gaussian)
summary(res2G)
siland.quantile(res2G,c(0.5,0.95))
plotsiland.land(res2G,land=landCmoth[c(1,2)],data=dataCmoth,var=1)
plotsiland.land(res2G,land=landCmoth[c(1,2)],data=dataCmoth,var=0)
plotsiland(res2G,landCmoth[c(1,2)],dataCmoth)
?geom_circle
source("../../Mefispa/siland/R/plotsiland.R")
plotsiland(res2G,landCmoth[c(1,2)],dataCmoth)
library(ggplot2)
plotsiland(res2G,landCmoth[c(1,2)],dataCmoth)
library(ggforce)
plotsiland(res2G,landCmoth[c(1,2)],dataCmoth)
source("../../Mefispa/siland/R/plotsiland.R")
plotsiland(res2G,landCmoth[c(1,2)],dataCmoth)
source("../../Mefispa/siland/R/plotsiland.R")
plotsiland(res2G,landCmoth[c(1,2)],dataCmoth)
source("../../Mefispa/siland/R/plotsiland.R")
plotsiland(res2G,landCmoth[c(1,2)],dataCmoth)
source("../../Mefispa/siland/R/plotsiland.R")
plotsiland(res2G,landCmoth[c(1,2)],dataCmoth)
?plotsiland.sif
plotsiland.sif(res2G)
?plotsif
remove.packages("siland")
q()
install.packages("~/Work/silandPackageGit/Downloads/PackageSource/siland_1.2.tar.gz", repos = NULL, type = "source")
library(siland)
ls()
rm(list = ls())
#Data loading with data() function
data(dataCmoth)
data(landCmoth)
res2G=siland(loc.model=Cmoth~trait,land=landCmoth[c(1,2)],data=dataCmoth,sif="gaussian",test=T,family=gaussian)
summary(res2G)
#Data loading with data.gis() and land.gis() functions
dataCmoth=data.gis(dsn="./GIS",layer="dataCarpo",varname=c("Cmoth","trait"))
landCmoth1=land.gis(dsn="./GIS",layer="landCarpo",varname="OrgConv",landname = c("conv","org"),wd=40)
landCmoth2=land.gis(dsn="./GIS",layer="landCarpo",varname="Vine",landname = "vine",wd=40)
landCmoth=c(landCmoth1,landCmoth2)
names(landCmoth)
res2G=siland(loc.model=Cmoth~trait,land=landCmoth[c(1,2)],data=dataCmoth,sif="gaussian",test=T,family=gaussian)
summary(res2G)
q()
library(siland)
#Importing data
##Data loading with data() function
data(dataCmoth)
data(landCmoth)
##Data loading with data.gis() and land.gis() functions
dataCmoth=data.gis(dsn="./GIS",layer="dataCarpo",varname=c("Cmoth","trait"))
landCmoth1=land.gis(dsn="./GIS",layer="landCarpo",varname="OrgConv",landname = c("conv","org"),wd=40)
landCmoth2=land.gis(dsn="./GIS",layer="landCarpo",varname="Vine",landname = "vine",wd=40)
landCmoth=c(landCmoth1,landCmoth2)
names(landCmoth)
#Fitting models with local and landscape variables
res3G=siland(loc.model=Cmoth~trait,land=landCmoth,data=dataCmoth,sif="gaussian",test=T,family=gaussian)
summary(res3G)
res2G=siland(loc.model=Cmoth~trait,land=landCmoth[c(1,2)],data=dataCmoth,sif="gaussian",test=T,family=gaussian)
summary(res2G)
#Estimation on a simulated example
?landSiland
?dataSiland
data("dataSiland")
data("landSiland")
siland(loc.model= y~locvar+(1|Id), land=landSiland, data=dataSiland, sif="exponential", test=T, family="poisson")
#Interpreting spatial influence functions (SIF)
res2=siland(loc.model= Cmoth~trait, land=landCmoth[c(1,2)],data=dataCmoth, sif="exponential", test=T,family=gaussian)
#Graphical representations
plotsiland(res2G,landCmoth[c(1,2)],dataCmoth)
plotsiland.land(res2G,land=landCmoth[c(1,2)],data=dataCmoth,var=1)
plotsiland.land(res2G,land=landCmoth[c(1,2)],data=dataCmoth,var=2)
plotsiland.land(res2G,land=landCmoth[c(1,2)],data=dataCmoth,var=0)
#Choice of the mesh
landCmothw200=land.gis(dsn="./GIS",layer="landCarpo",varname="OrgConv",landname = c("conv","org"),wd=200)
res2Gw200=siland(loc.model=Cmoth~trait,land=landCmothw200,data=dataCmoth,sif="gaussian",test=T,family=gaussian)
summary(res2Gw200)
landCmothw20=land.gis(dsn="./GIS",layer="landCarpo",varname="OrgConv",landname = c("conv","org"),wd=20)
res2Gw20=siland(loc.model=Cmoth~trait,land=landCmothw20,data=dataCmoth,sif="gaussian",test=F,family=gaussian)
summary(res2Gw20)
res2Gw20=siland(loc.model=Cmoth~trait,land=landCmothw20,data=dataCmoth,sif="gaussian",test=T,family=gaussian)
library(siland)
?plotsiland.sif
plotcontri
