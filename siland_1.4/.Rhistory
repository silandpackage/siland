unique(naizin.parcel$TYPE)
plot(naizin.parcel[,4], pal=c("orange","gold","springgreen1","darkolivegreen1", "darkviolet","brown1","snow","forestgreen","darkgrey","cadetblue1"), main="Type d'occupation du sol")
plot(naizin.parcel[,4], col="white")
plot(naizin.haie, col="red", add=T, type="l", main="")
r <- raster(system.file("extdata/r.tif", package="ecpaysage2"))
plot(r, axes=F, addfun=plot(contours, add=TRUE), box=F, main="r")
plot(r, axes=F, box=F, main="r")
dev.off()
plot(r, axes=F, box=F, main="r")
ra <- aggregate(r, fact=10, fun=min)
plot(ra, axes=F, addfun=plot(contours, add=TRUE), box=F, main="aggregate(r, fact=10, fun=min)")
contours <- readShapeSpatial(system.file("extdata/contours.shp", package="ecpaysage2"))
plot(r, axes=F, addfun=plot(contours, add=TRUE), box=F, main="r")
ra <- aggregate(r, fact=10, fun=min)
plot(ra, axes=F, addfun=plot(contours, add=TRUE), box=F, main="aggregate(r, fact=10, fun=min)")
rb <- aggregate(r, fact=10, fun=max)
plot(rb, axes=F, addfun=plot(contours, add=TRUE), box=F, main="aggregate(r, fact=10, fun=max)")
ra <- aggregate(r, fact=10, fun=min)
plot(ra, axes=F, addfun=plot(contours, add=TRUE), box=F, main="aggregate(r, fact=10, fun=min)")
plot(rb, axes=F, addfun=plot(contours, add=TRUE), box=F, main="aggregate(r, fact=10, fun=max)")
r
r@data
r@data$data
r@data$r
r
r@data
r@data[1:10,]
class(r)
r@data$r
r@data$]
r@data
r <- raster(system.file("extdata/r.tif", package="ecpaysage2"))
contours <- readShapeSpatial(system.file("extdata/contours.shp", package="ecpaysage2"))
plot(r, axes=F, addfun=plot(contours, add=TRUE), box=F, main="r")
?aggregate
r
r$values
r$r
r
r@z
r@data
r@data$r
r@data
crop(x, y, filename="", snap='near', datatype=NULL, ...)
r <- raster(system.file("extdata/r.tif", package="ecpaysage2"))
e <- extent(754843, 776893, 6286616, 6303016)
rc <- crop(x=r, y=e)
plot(r)
plot(rc)
r
r <- raster(nrow=10, ncol=10)
r[] <- 1:ncell(r)
mean(r[])
r
plot(r)
r@data
r@data
r@data$values
r$values
r@values
r@data
r@data$values
r@data::values
r
r@vales
r@values
r@data
r@data@values
unique(r)
unique(r@data@values)
w <- which(r[]==2)
r[w] <- 10
plot(r)
r <- raster(system.file("extdata/r.tif", package="ecpaysage2"))
e1 <- extent(754843, 760893, 6296616, 6303016)
r1 <- crop(x=r, y=e1)
e2 <- extent(768843, 776893, 6286616, 6303016)
r2 <- crop(x=r, y=e2)
plot(r1)
plot(r2)
rm <- merge(r1, r2)
plot(rm)
#####rasteriser shapefiule
library(sf) ; library(maptools) ; library(raster)
parcellairef <- paste(system.file(package="ecpaysage2"), '/extdata/', "naizin_parcellaire_2013_L93.shp", sep='')
naizin.parcel <- sf::st_read(parcellairef)
unique(naizin.parcel$TYPE)
r <- raster(ncol=200, nrow=200)
extent(r) <- extent(naizin.parcel)
rp <- rasterize(naizin.parcel, r, 'TYPE')
plot(rp)
rp
coordinates(df) <- c("x", "y") # pour créer un objet SpatialPointsDataFrame
plot(rp)
rp
coordinates(df) <- c("x", "y") # pour créer un objet SpatialPointsDataFrame
library(raster) ; library(sp)
x <- c(435226.7, 435221.7, 435226.7, 435231.7, 435216.7, 435221.7, 435226.7, 435231.7, 435236.7, 435211.7, 435216.7, 435221.7, 435226.7, 435231.7, 435236.7, 435241.7, 435206.7, 435211.7, 435216.7, 435221.7)
y <- c(703860.7, 703855.7, 703855.7, 703855.7, 703850.7, 703850.7, 703850.7, 703850.7, 703850.7, 703845.7, 703845.7, 703845.7, 703845.7, 703845.7, 703845.7, 703845.7, 703840.7, 703840.7, 703840.7, 703840.7)
z <- rnorm(n=length(x))
df <- data.frame(x=x, y=y, z=z)
head(df)
coordinates(df) <- c("x", "y") # pour créer un objet SpatialPointsDataFrame
bubble(obj=df, zcol="z", maxsize = 2.5, main = "z")
r <- raster(e, crs="+proj=utm +zone=31 +datum=WGS84 +units=m +no_defs +ellps=WGS84 +towgs84=0,0,0", res=5)
r.z <- rasterize(df[, 1:2], r, df[,3])
df <- data.frame(df) # retour à un objet data.frame
e <- extent(df[,1:2])
e
r <- raster(e, crs="+proj=utm +zone=31 +datum=WGS84 +units=m +no_defs +ellps=WGS84 +towgs84=0,0,0", res=5)
r.z <- rasterize(df[, 1:2], r, df[,3])
plot(r.z)
r <- raster(system.file("extdata/r.tif", package="ecpaysage2"))
res(r)
r <- raster(system.file("extdata/r.tif", package="ecpaysage2"))
contours <- readShapeSpatial(system.file("extdata/contours.shp", package="ecpaysage2"))
res(r)
class <- ClassStat(mat=r, cellsize = 50, bkgd = NA, latlon = FALSE)
library(raster) ; library(landscapemetrics)
library(landscapetools) ; library(ggplot2)
r <- raster(system.file("extdata/r.tif", package="ecpaysage2"))
check_landscape(r)
install.packages("landscapetools")
r <- raster(system.file("extdata/r.tif", package="ecpaysage2"))
check_landscape(r)
crs(r) <- "+proj=lcc +lat_1=49 +lat_2=44 +lat_0=46.5 +lon_0=3 +x_0=700000 +y_0=6600000 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs"
check_landscape(r)
lsm_p_enn(r)
lsm_l_shdi(r)
l <- list_lsm(level = "landscape", metric = NULL, name = NULL, type = NULL, what = NULL, simplify = FALSE, verbose = TRUE)
as.data.frame(l)
l <- list_lsm(level = "patch", metric = NULL, name = NULL, type = NULL, what = NULL, simplify = FALSE, verbose = TRUE)
as.data.frame(l)
lsm_p_shape(r)
lsm_c_pland(r)
plot(r)
class(r)
r@data@values
r@data@min
r@data@max
r@data@values
r
r[]
r@data
r
r
r[]
r@data@values
r@data@values
r
r@data
r@data@values
r@data@attributes
r@z
r
r@data@values
r[]
r@data@values
unique(r[])
values(r)
values(r)
values
?values
getValues
values(r)
r@data@offset
r@data@gain
r@data@attributes
getValues()
getValues
getValues()
?values
r
r
r[]
r@data@unit
r@data@values
class(r)
r@data@inmemory
r@data
r@data@fromdisk
calculate_lsm(r, level = "landscape")
##exercice
library(raster)
patched_raster  <-  get_patches(r, 1)
plot(patched_raster[[1]])
# dénombrement des patches
length(raster::unique(patched_raster[[1]]))
plot(r)
plot(patched_raster[[1]])
patched_raster
# dénombrement des patches
length(raster::unique(patched_raster[[1]]))
shape <- lsm_p_shape(r)
dim(shape)
shape
shape
dim(shape)
60*50/2
patched_raster
length(patched_raster)
patched_raster
class(patched_raster)
length(patched_raster)
length(patched_raster[[1]]
]
length(patched_raster[[1]])
length(raster::unique(patched_raster[[1]]))
shape
shape$id
r
plot(patched_raster[[1]])
dim(shape)
shape <- lsm_p_shape(patched_raster)
dim(shape)
shape <- lsm_p_shape(r)
shape_classe1 <- data.frame(shape[shape$class==1,6])
dim(shape_classe1)
ra <- patched_raster[[1]]
plot(ra)
unique(ra[])
for(p in 1:(length(raster::unique(patched_raster[[1]])))) {
w <- which(ra[]==unique(patched_raster[[1]])[p]) ; w
ra[w] <- shape_classe1[p,]
}
plot(ra, main="shape index pour les \npatches de la classe 1 (bâti)")
contours <- readShapeSpatial(system.file("extdata/contours.shp", package="ecpaysage2"))
r <- raster(system.file("extdata/r.tif", package="ecpaysage2"))
crs(r) <- "+proj=lcc +lat_1=49 +lat_2=44 +lat_0=46.5 +lon_0=3 +x_0=700000 +y_0=6600000 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs"
contours <- readShapeSpatial(system.file("extdata/contours.shp", package="ecpaysage2"))
plot(r, axes=F, addfun=plot(contours, add=TRUE), box=F)
s <- sampleRandom(r, size=1, xy=TRUE) ; s
plot(r, axes=F, addfun=plot(contours, add=TRUE), box=F)
points(s[1,1], s[1,2], pch=3)
rbis <- r
rbis[]<-NA
points<-data.frame(s[1,1], s[1,2])
names(points)<-c("x","y")
cell<-cellFromXY(object=r,xy=points[1,])
radius<-7000
rbis[cell]<-1
rasterOptions(todisk=TRUE) ##bug #https://gis.stackexchange.com/questions/264133/raster-buffer-error-with-package-updates
buf <- buffer(rbis, width=radius)
rasterOptions(todisk=FALSE) ##bug #https://gis.stackexchange.com/questions/264133/raster-buffer-error-with-package-updates
plot(buf)
unique(buf[])
p <- which(buf[]==1)
buf[p] <- r[p] #re
plot(buf)
buf
buf@data@values
buf
xmin<-points$x[1] - 2*radius
xmax<-points$x[1] + 2*radius
ymin<-points$y[1] - 2*radius
ymax<-points$y[1] + 2*radius
ev<-c(xmin, xmax, ymin, ymax)
e<-extent(ev)
e
buffer<-crop(buf,e)
plot(buffer)
points(points$x,points$y,pch=3)
res(buffer)
class <- ClassStat(mat=buffer, cellsize = 50, bkgd = NA, latlon = FALSE)
library(landscapeR) ; library(raster)
m <- matrix(0, 33, 33)
r <- raster(m, xmn=0, xmx=10, ymn=0, ymx=10)
plot(r)
?makeClass
num <- 5
size <- 15
rr <- makeClass(context=r, npatch=num, size=size)
plot(rr)
num <- 75
size <- 10
rr <- makeClass(r, num, size)
plot(rr)
num <- 5
size <- c(1,5,10,20,50)
pts <- c(1, 33, 1089, 1057, 545)
rr <- makeClass(r, num, size, pts)
plot(rr)
rr <- makeClass(r, 3, 100, val=1)
rr <- makeClass(rr, 5, 50, val=3) ## Creates a second class in the landscape with value 3
par(mfrow=c(1,2))
plot(rr)
rr <- makeClass(rr, 1, 250, bgr=c(0,1), val=2) ## Builds a third class, allowed on background and class 1.
plot(rr)
library(landscapeR) ; library(raster)
m <- matrix(0, 50, 50)
r1 <- raster(m, xmn=0, xmx=10, ymn=0, ymx=10)
plot(r1)
r2 <- makeClass(context=r1, npatch=3, size=100, val=1)
plot(r2)
r3 <- makeClass(context=r2, npatch=3, size=50, bgr=c(0), val=2) ## Creates a second class in the landscape with value 3
plot(r3)
par(mfrow=c(2,2))
plot(r2, col=c("grey", "green"))
plot(r3, col=c("grey", "green", "red"))
plot(r4, col=c("grey", "green", "red", "blue"))
r4 <- makeClass(context=r3, npatch=1, size=40, bgr=c(0), val=3) ## Creates a second class in the landscape with value 3
plot(r4)
par(mfrow=c(2,2))
plot(r2, col=c("grey", "green"))
plot(r3, col=c("grey", "green", "red"))
plot(r4, col=c("grey", "green", "red", "blue"))
par(mfrow=c(1,2))
hist(unlist(list.shdi))
hist(unlist(list.ed))
library(NLMR) ; library(raster) ; library(checkmate) ; library(landscapetools)
x <- nlm_random(20,20)
class(x)
plot(x)
?nlm_fbm
nr <- nlm_fbm(40, 40, fract_dim = 1.2)
plot(nr)
nr_classified <- util_classify(nr, weighting = c(0.3, 0.3, 0.3))
plot(nr_classified)
d01 <- util_classify(nlm_fbm(40, 40, fract_dim = 0.1), weighting = c(0.3, 0.3, 0.3))
plot(d01)
?dist
q()
getpwd()
pwd()
getpwd
rm(list=ls())
library(fields)
library(maptools)
library(sp)
library(spatstat)
library(sf)
library(rgdal)
library(rgeos)
library(raster)
library(coda)
library(rjags)
load("dataset_spoggi.Rdata")
DONloc <- matrix(unlist(dataWW$geometry),ncol=2,byrow=T)
head(DONloc)
covar.df <- cbind(dataWW$meadow1_300,dataWW$nbUFL,dataWW$Year)
covar.df <- as.data.frame(covar.df)
names(covar.df) <- c("meadow1_300","nbUFL","Year")
covar.df$xcoor <- DONloc[,1]
covar.df$ycoor <- DONloc[,2]
covar.df$intercept <- 1
covar.df$nbUFL <- as.factor(covar.df$nbUFL)
covar.df$Year <- as.factor(covar.df$Year)
head(covar.df)
ycount <- dataWW$Agriotes
head(ycount)
setwd("C:/Users/biosp/Desktop/TDjulien/TDmcmc")
load("dataset_spoggi.Rdata")
DONloc <- matrix(unlist(dataWW$geometry),ncol=2,byrow=T)
head(DONloc)
covar.df <- cbind(dataWW$meadow1_300,dataWW$nbUFL,dataWW$Year)
covar.df <- as.data.frame(covar.df)
names(covar.df) <- c("meadow1_300","nbUFL","Year")
covar.df$xcoor <- DONloc[,1]
covar.df$ycoor <- DONloc[,2]
covar.df$intercept <- 1
covar.df$nbUFL <- as.factor(covar.df$nbUFL)
covar.df$Year <- as.factor(covar.df$Year)
head(covar.df)
ycount <- dataWW$Agriotes
head(ycount)
ycount
#Les contours du domaine
naizin_sp <- as_Spatial(naizin$geom)
taille_domaine <- as(extent(naizin_sp), 'SpatialPolygons')
projection(taille_domaine) <- projection(naizin_sp)
paysage.tmp <- gDifference(taille_domaine,naizin_sp)
paysage <- gDifference(taille_domaine,paysage.tmp)
#Les observations
DONloc.sp <- SpatialPoints(DONloc)
projection(DONloc.sp) <- projection(paysage)
rapport_def <- ((extent(paysage)@xmax-extent(paysage)@xmin) / (extent(paysage)@ymax-extent(paysage)@ymin))
resoly=5
resolx=round(resoly*rapport_def)
ext.dep<- extent(paysage)
r <- raster(ncols=resolx,nrows=resoly,ext=ext.dep)
p2 <- as(r, 'SpatialPolygons')
projection(p2) <- projection(paysage)
#Intersection avec la zone
grille.tmp <- intersect(paysage, p2)
#Un SpatialPolygons avec seulement des polygones formés d'un seul polygone
toto <- list()
indice <- 0
for (i in 1:length(grille.tmp@polygons)){
nbpoly <- length(grille.tmp@polygons[[i]]@Polygons)
for (j in 1:nbpoly){
indice <- indice+1
toto[[indice]] <- SpatialPolygons(list(Polygons(list(grille.tmp@polygons[[i]]@Polygons[[j]]),ID=indice)))
}
}
grille.tmp <- do.call(bind,toto)
projection(grille.tmp) <- projection(paysage)
#plot
options(repr.plot.width=5,repr.plot.height=5)
par(mar=c(0,0,0,0))
plot(grille.tmp)
plot(DONloc.sp,add=T)
options(repr.plot.width=10,repr.plot.height=5)
par(mfrow=c(1,2),mar=c(0,0,2,2))
plot(paysage,main=2018)
cex <- (dataWW$Agriotes+1)/max(dataWW$Agriotes+1)
points(DONloc,cex=cex*10,pch=16,col=c(1,0)[as.numeric(dataWW$Year)])
plot(paysage,main=2019)
cex <- (dataWW$Agriotes+1)/max(dataWW$Agriotes+1)
points(DONloc,cex=cex*10,pch=16,col=c(0,1)[as.numeric(dataWW$Year)])
rapport_def <- ((extent(paysage)@xmax-extent(paysage)@xmin) / (extent(paysage)@ymax-extent(paysage)@ymin))
resoly=5
resolx=round(resoly*rapport_def)
ext.dep<- extent(paysage)
r <- raster(ncols=resolx,nrows=resoly,ext=ext.dep)
p2 <- as(r, 'SpatialPolygons')
projection(p2) <- projection(paysage)
#Intersection avec la zone
grille.tmp <- intersect(paysage, p2)
#Un SpatialPolygons avec seulement des polygones formés d'un seul polygone
toto <- list()
indice <- 0
for (i in 1:length(grille.tmp@polygons)){
nbpoly <- length(grille.tmp@polygons[[i]]@Polygons)
for (j in 1:nbpoly){
indice <- indice+1
toto[[indice]] <- SpatialPolygons(list(Polygons(list(grille.tmp@polygons[[i]]@Polygons[[j]]),ID=indice)))
}
}
grille.tmp <- do.call(bind,toto)
projection(grille.tmp) <- projection(paysage)
#plot
options(repr.plot.width=5,repr.plot.height=5)
par(mar=c(0,0,0,0))
plot(grille.tmp)
plot(DONloc.sp,add=T)
ls()
dataWW
dataWW$ycount
dataWW$Agriotes
dd=as.data.frame(dataWW)
colnames(dd)
dd$geometry
class(dd)
coordinates(dataWW)
st_coordinates(dataWW)
dd=cbind(st_coordinates(dataWW),as.fata.frame(dataWW))
dd=cbind(st_coordinates(dataWW),as.data.frame(dataWW))
dd
dd[1:10,]
plot(dd[1:2,])
plot(dd[,1:2])
library(siland)
data(landCmoth)
data(dataCmoth)
resB=Bsiland(Cmoth~trait+org+conv,data=dataCmoth,land=landCmoth)
resB
resB=Bsiland(Cmoth~trait+org+conv,data=dataCmoth,land=landCmoth,initb = 50)
resB
resB=Bsiland(Cmoth~trait+org+conv,data=dataCmoth,land=landCmoth,initb=100)
data(dataSiland)
dataSiland[1:10,]
landSiland
data(landSiland)
landSiland
help(Bsiland)
?AIC
install.packages("rmarkdown")
install pandoc
setwd("C:/Users/biosp/Desktop/GitSiland/siland/siland_1.4")
devtools::use_vignette("my-vignette")
knit_with_parameters('C:/Users/biosp/Desktop/GitSiland/siland/siland_1.4/vignettes/siland.Rmd')
tinytex::install_tinytex()
vignette(ade4)
vignette("ade4")
packageDescription()
vignette("briskaR")
vignette("coda")
?vignette
vignette(all = TRUE)
vignette("amap")
vignette(all=T)
vignette(briskaR)
vignette("briskaR")
library(briskaR)
vignette("briskaR")
browseVignettes("briskaR")
browseVignettes("rmarkdown")
vignette(all=T)*
1
vignette(all=T)
browseVignettes("intro")
browseVignettes("maptools")
sys.Date(26-10-2018)
sys.Date("26-10-2018")
Sys.Date("26-10-2018")
browseVignettes("briskaR")
library(siland)
plot(geomtrey(landSiland))
plot(geomtry(landSiland))
plot(geometry(landSiland))
library(sf)
plot(geometry(landSiland))
plot(st_geometry(landSiland))
dev.off()
plot(st_geometry(landSiland))
plot(st_geometry(landSiland$L1),col=2,add=T)
landSiland$L1
plot(st_geometry(landSiland$L1),col=2,add=T)
sel=landSiland$L1==1
plot(st_geomtry(landSiland[sel,]))
sel=landSiland$L1==1
plot(st_geometry(landSiland[sel,]))
